<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="RuangJahit hadir untuk membantu Anda dalam menemukan jasa penjahit terbaik dan
    memberikan ruang untuk jasa penjahit agar dapat lebih dikenal oleh banyak orang.">
    <meta name="theme-color" content="#FF8A00"/>   
    <meta name="keywords" content="jasa jahit, produk lokal">

    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    <link rel="manifest" href="./app.webmanifest">
    <link rel="icon" href="./ruangjahit.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <title>RuangJahit</title>
</head>
<body>
    <app-bar style="display: none;"></app-bar>
    <app-bar_user style="display: none;"></app-bar_user>
    <app-bar-tailor style="display: none;"></app-bar-tailor>
    <main id="mainContent"></main>
    <footer-bar></footer-bar>
    
    <script src="./controller/user/Authentication.js"></script>
    <script src="./controller/tailor/Authentication.js"></script>
    <script src="./js/style.js"></script>
    <script>
        function ProfileEdit() {
        const name = document.getElementById('edit_name');
        const username = document.getElementById('edit_username');
        const first_address = document.getElementById('edit_first_address');
        const first_phone = document.getElementById('edit_first_phone');
        const province_id = document.getElementById('edit_province_id');
        const regency_id = document.getElementById('edit_regency_id');
        const zip_code = document.getElementById('edit_zip_code');
    
        const data = JSON.stringify({
            name: name.value,
            username: username.value,
            password_confirmation: password_confirmation.value,
            first_address: first_address.value,
            province_id: province_id.value,
            regency_id: regency_id.value,
            zip_code: zip_code.value,
            first_phone: first_phone.value,
        });

        token = localStorage.getItem('token');

        const url = 'https://backend-ruangjahit-production.up.railway.app/api/users/edit';
        fetch(url, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json',
                'Authorization': `Bearer ${token}`,
            },
            body: data,
        }).then((response) => response.json().then((data) => {
            console.log(response.status);
            if (response.status == 200) {
                alert('Data Berhasil Diubah!');
                name.value = '';
                username.value = '';
                password_confirmation.value = '';
                first_address.value = '';
                province_id.value = '';
                regency_id.value = '';
                zip_code.value = '';
                first_phone.value = '';
                location.reload();
            } else {
                console.log(data);
                alert(`Error, terjadi kesalahan ${data.message}`);
            }
        })).catch((error) => {
            alert(`Error, terjadi kesalahan ${error}`);
        });
        }

        function GetUserProfile() {
            token = localStorage.getItem('token');

            const url = 'https://backend-ruangjahit-production.up.railway.app/api/user';
            fetch(url, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`,
                },
            }).then((response) => response.json().then((data)=> {
                let UserData = '';
                    UserData += `
                        <p style="font-size: 1.5rem;"><strong>${data.data.name}</strong></p>
                        <p>${data.data.username}</p>
                        <p>${data.data.first_phone} - ${data.data.first_address}</p>
                    `;
                document.getElementById('user_name').innerHTML = UserData;
            }));
        }

        function GetTailorProfile() {
            token = localStorage.getItem('token');

            const url = 'https://backend-ruangjahit-production.up.railway.app/api/user';
            fetch(url, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`,
                },
            }).then((response) => response.json().then((data)=> {
                let UserData = '';
                    UserData += `
                        <p style="font-size: 1.5rem;"><strong>${data.data.store_name}</strong></p>
                        <p><strong>${data.data.username} </strong> ${data.data.name}</p>
                        <p>${data.data.first_phone} - ${data.data.first_address}</p>
                        <small>
                        <span class="category" style="font-size: 0.8rem;">${data.data.store_status}</span>
                        </small>
                    `;
                document.getElementById('user_name').innerHTML = UserData;
            }));
        }
        
        </script>
</body>
</html>
